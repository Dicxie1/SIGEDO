@model Asistencia.Models.ViewModels.ProgrammaticProgressViewModel
@{
    ViewData["Title"] = "Avance Programático";
}

<div class="container py-4">
    
    <div class="d-flex justify-content-between align-items-center mb-4 no-print">
        <div>
            <h3 class="fw-bold mb-0">Avance Programático</h3>
            <p class="text-muted">@Model.CourseName</p>
        </div>
        <div class="d-flex gap-2">
            <form method="get" class="d-flex align-items-center">
                <input type="hidden" name="courseId" value="@ViewBag.CourseId" />
                <label class="me-2 small fw-bold">Corte:</label>
                <select name="termId" class="form-select form-select-sm" onchange="this.form.submit()">
                    @foreach(var term in ViewBag.Terms)
                    {
                        // Seleccionar el actual
                        if(term.TermId == Model.TermId)
                        {
                            <option value="@term.TermId" selected>@term.Name</option>
                        } else {
                            <option value="@term.TermId">@term.Name</option>
                        }
                    }
                </select>
            </form>
            
            <button onclick="window.print()" class="btn btn-outline-dark btn-sm">
                <i class="fas fa-print me-1"></i> Imprimir
            </button>
        </div>
    </div>
    <div class="card shadow-sm border-0">
    <div class="table-responsive">
        <table class="table table-bordered text-center align-middle mb-0" style="min-width: 1400px;">
            <thead class="bg-light fw-bold text-uppercase small text-secondary">
                <tr>
                    <td colspan="3" class="bg-primary bg-opacity-10 text-primary">Matrícula Inicial</td>
                    <td colspan="3" class="bg-success bg-opacity-10 text-success">Matrícula Final</td>
                    
                    <td colspan="3" class="bg-warning bg-opacity-10 text-dark">No Examinados</td>
                    <td colspan="3">Aprobados</td>
                    <td colspan="3">% Aprobados</td>
                    <td colspan="3">Reprobados</td>
                    <td colspan="3">% Reprobados</td>
                </tr>
                <tr class="text-muted" style="font-size: 0.75rem;">
                    @for(int i=0; i<6; i++) {
                        if(i == 0){
                            <td class="bg-primary bg-opacity-10 text-primary">H</td> 
                            <td class="bg-primary bg-opacity-10 text-primary">M</td> 
                            <td class="bg-primary bg-opacity-10 text-primary">T</td>
                        }
                        <td>H</td>
                        <td >M</td>
                        <td >T</td>
                    }
                </tr>
            </thead>
            <tbody class="fw-bold text-dark">
                <tr>
                    <td class="bg-primary bg-opacity-10 text-primary">@Model.Initial.Male</td>
                    <td class="bg-primary bg-opacity-10 text-primary">@Model.Initial.Female</td>
                    <td class="bg-primary bg-opacity-25 text-primary">@Model.Initial.Total</td>

                    <td>@Model.Final.Male</td>
                    <td>@Model.Final.Female</td>
                    <td class="bg-light">@Model.Final.Total</td>

                    <td class="text-warning">@Model.NotExamined.Male</td>
                    <td class="text-warning">@Model.NotExamined.Female</td>
                    <td class="bg-light text-dark border-start border-end">@Model.NotExamined.Total</td>


                    <td class="text-primary">@Model.Approved.Male</td>
                    <td class="text-primary">@Model.Approved.Female</td>
                    <td class="bg-light text-primary">@Model.Approved.Total</td>

                    <td class="text-muted small">@Model.ApprovedPct.Male%</td>
                    <td class="text-muted small">@Model.ApprovedPct.Female%</td>
                    <td class="bg-light text-dark small">@Model.ApprovedPct.Total%</td>

                    <td class="text-danger">@Model.Failed.Male</td>
                    <td class="text-danger">@Model.Failed.Female</td>
                    <td class="bg-light text-danger">@Model.Failed.Total</td>

                    <td class="text-muted small">@Model.FailedPct.Male%</td>
                    <td class="text-muted small">@Model.FailedPct.Female%</td>
                    <td class="bg-light text-dark small">@Model.FailedPct.Total%</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
</div>

<style media="print">
    .no-print { display: none !important; }
    .card { border: 1px solid #ddd !important; box-shadow: none !important; }
    .progress { display: none; } /* Ocultar barras de progreso al imprimir */
</style>